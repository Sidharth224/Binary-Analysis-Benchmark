#!/bin/bash

set -x
set -e

export OLD_CVE1=CVE-2021-3323
export OLD_CVE2=2021-3323
export NEW_CVE1=CVE-2021-3329
export NEW_CVE2=2021-3329
export ZEPHYR_VER=2.2.0

export BASE_COMMIT_AS=e1dddf7befa7309bd2afc567b2e00d2e7362f7c4
export FIX_COMMIT_AS=

export DATBASE_HOME=/home/sidharth/dataset-creation/zephyr-binaries

mkdir $DATBASE_HOME/$NEW_CVE1/ARC-Boards
mkdir $DATBASE_HOME/$NEW_CVE1/ARM-Boards
mkdir $DATBASE_HOME/$NEW_CVE1/RISCV-Boards
mkdir $DATBASE_HOME/$NEW_CVE1/X86-Boards

cp $DATBASE_HOME/$OLD_CVE1/ARC-Boards/ARC-$OLD_CVE2.sh $DATBASE_HOME/$NEW_CVE1/ARC-Boards/ARC-$NEW_CVE2.sh
cp $DATBASE_HOME/$OLD_CVE1/ARM-Boards/ARM-$OLD_CVE2.sh $DATBASE_HOME/$NEW_CVE1/ARM-Boards/ARM-$NEW_CVE2.sh
cp $DATBASE_HOME/$OLD_CVE1/RISCV-Boards/RISCV-$OLD_CVE2.sh $DATBASE_HOME/$NEW_CVE1/RISCV-Boards/RISCV-$NEW_CVE2.sh
cp $DATBASE_HOME/$OLD_CVE1/X86-Boards/X86-$OLD_CVE2.sh $DATBASE_HOME/$NEW_CVE1/X86-Boards/X86-$NEW_CVE2.sh
cp $DATBASE_HOME/$OLD_CVE1/$OLD_CVE1-build.sh $DATBASE_HOME/$NEW_CVE1/$NEW_CVE1-build.sh

"$DATBASE_HOME/$NEW_CVE1/ARC-Boards/ARC-$NEW_CVE2.sh" 
"$DATBASE_HOME/$NEW_CVE1/ARM-Boards/ARM-$NEW_CVE2.sh"
"$DATBASE_HOME/$NEW_CVE1/RISCV-Boards/RISCV-$NEW_CVE2.sh"
"$DATBASE_HOME/$NEW_CVE1/X86-Boards/X86-$NEW_CVE2.sh"